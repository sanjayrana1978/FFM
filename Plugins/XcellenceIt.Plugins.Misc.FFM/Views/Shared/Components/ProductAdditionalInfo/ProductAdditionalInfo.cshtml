@model ProductAdditionalInfoModel
@using XcellenceIt.Plugins.Misc.FFM.Models.ProducstAdditinalInfo

@if (Model.ProductId > 0)
{
    <div class="card-body">
        <div class="form-group row">
            <div class="col-md-3">
                <nop-label asp-for="IngredientsInfomation" />
            </div>
            <div class="col-md-9">
                <nop-editor asp-for="IngredientsInfomation" asp-template="RichEditor" />
                <span asp-validation-for="IngredientsInfomation"></span>
            </div>
        </div>
        <div class="form-group row">
            <div class="col-md-3">
                <nop-label asp-for="NutritionalInfomation" />
            </div>
            <div class="col-md-9">
                <nop-editor asp-for="NutritionalInfomation" asp-template="RichEditor" />
                <span asp-validation-for="NutritionalInfomation"></span>
            </div>
        </div>
        <div class="form-group row">
            <div class="col-md-9 offset-md-3">
                <button type="button" id="BtnSaveID" name="save" class="btn btn-primary">@T("Admin.Common.Save")</button>
            </div>
        </div>
    </div>

       <script asp-Location="Footer">
        $(document).ready(function() {
            $('#BtnSaveID').click(function(){
                    $("#ajaxBusy").show();
                var ProductId = $("#@Html.IdFor(model => model.Id)").val();
                var IngredientsInfomation =  tinyMCE.get('@Html.IdFor(model => model.IngredientsInfomation)').getContent();
                var NutritionalInfomation =  tinyMCE.get('@Html.IdFor(model => model.NutritionalInfomation)').getContent();
              
                var postData = {
                    productId : ProductId,
                    ingredientsInfomation: IngredientsInfomation,
                    nutritionalInfomation: NutritionalInfomation
                };
                
                addAntiForgeryToken(postData);
                console.log(postData);
                $.ajax({
                    url: '@Url.Action("ProductAdditionalInfoTab", "FFM")',
                    type: "POST",
                    data: postData,
                    success: function (data, textStatus, jqXHR) {
                        if (data.result == true) {
                             $("#ajaxBusy").hide();
                             $("#productinfoAlert").click();
                        }
                        else{
                             $("#productinfoAlertError").click();
                        }
                    },
                });
            });
        });
    </script>
}
else
{
    <div class="card-body">
        @T("Plugins.Misc.FFM.Admin.Product.ProductAdditionalInfoModel.SaveBeforeEdit")
    </div>
}
 <nop-alert asp-alert-id="productinfoAlert" asp-alert-message="@T("Plugins.Misc.FFM.Admin.Product.ProductAdditionalInfo.Tab.Updated")" />
 <nop-alert asp-alert-id="productinfoAlertError" asp-alert-message="@T("Plugins.Misc.FFM.Admin.Encrypt.FailNotification")"/>
